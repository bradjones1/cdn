<?php

/**
 * @file
 * Implements the core hooks, public and private functions.
 */


require_once('cdn.constants.inc');


//----------------------------------------------------------------------------
// Drupal core.

/**
 * Implements hook_file_url_alter().
 */
function cdn_file_url_alter(&$uri) {
  // Don't alter file URLs when running update.php.
  if (defined('MAINTENANCE_MODE')) {
    return;
  }

  $result = \Drupal::service('cdn.file_url_generator')->generate($uri);
  if ($result) {
    $uri = $result;
  }
}


//----------------------------------------------------------------------------
// Public functions.

/**
 * Helper function to efficiently load include files for this module.
 */
function cdn_load_include($basename) {
  module_load_include('inc', 'cdn', "cdn.$basename");
}
